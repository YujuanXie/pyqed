<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyqed.beam package &mdash; PyQED 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=af2ce170"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PyQED
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">pyqed</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide/guide.html">Users Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="developers.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="heom.html">heom module</a></li>
<li class="toctree-l1"><a class="reference internal" href="Floquet.html">Floquet package</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyqed.pyqed.signal.html">pyqed.pyqed.signal package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyQED</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pyqed.beam package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pyqed.beam.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pyqed-beam-package">
<h1>pyqed.beam package<a class="headerlink" href="#pyqed-beam-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pyqed.beam.config">
<span id="pyqed-beam-config-module"></span><h2>pyqed.beam.config module<a class="headerlink" href="#module-pyqed.beam.config" title="Permalink to this heading"></a></h2>
<p>Configuration file. Standard py_lab units are mm.</p>
</section>
<section id="pyqed-beam-scalar-fields-x-module">
<h2>pyqed.beam.scalar_fields_X module<a class="headerlink" href="#pyqed-beam-scalar-fields-x-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-scalar-fields-xy-module">
<h2>pyqed.beam.scalar_fields_XY module<a class="headerlink" href="#pyqed-beam-scalar-fields-xy-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-scalar-fields-xyz-module">
<h2>pyqed.beam.scalar_fields_XYZ module<a class="headerlink" href="#pyqed-beam-scalar-fields-xyz-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-scalar-fields-xz-module">
<h2>pyqed.beam.scalar_fields_XZ module<a class="headerlink" href="#pyqed-beam-scalar-fields-xz-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-scalar-fields-z-module">
<h2>pyqed.beam.scalar_fields_Z module<a class="headerlink" href="#pyqed-beam-scalar-fields-z-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-scalar-masks-x-module">
<h2>pyqed.beam.scalar_masks_X module<a class="headerlink" href="#pyqed-beam-scalar-masks-x-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-scalar-masks-xy-module">
<h2>pyqed.beam.scalar_masks_XY module<a class="headerlink" href="#pyqed-beam-scalar-masks-xy-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-scalar-masks-xyz-module">
<h2>pyqed.beam.scalar_masks_XYZ module<a class="headerlink" href="#pyqed-beam-scalar-masks-xyz-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-scalar-masks-xz-module">
<h2>pyqed.beam.scalar_masks_XZ module<a class="headerlink" href="#pyqed-beam-scalar-masks-xz-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-scalar-sources-x-module">
<h2>pyqed.beam.scalar_sources_X module<a class="headerlink" href="#pyqed-beam-scalar-sources-x-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-scalar-sources-xy-module">
<h2>pyqed.beam.scalar_sources_XY module<a class="headerlink" href="#pyqed-beam-scalar-sources-xy-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pyqed.beam.utils_common">
<span id="pyqed-beam-utils-common-module"></span><h2>pyqed.beam.utils_common module<a class="headerlink" href="#module-pyqed.beam.utils_common" title="Permalink to this heading"></a></h2>
<p>Common functions to classes</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_common.clear_all">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_common.</span></span><span class="sig-name descname"><span class="pre">clear_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_common.clear_all" title="Permalink to this definition"></a></dt>
<dd><p>clear all variables</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_common.computer_parameters">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_common.</span></span><span class="sig-name descname"><span class="pre">computer_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_common.computer_parameters" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Determine several computer parameters:</dt><dd><ul class="simple">
<li><p>number of processors</p></li>
<li><p>available memory</p></li>
<li><p>total memory</p></li>
<li><p>max frequency</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em>) – If True prints data</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>number of processors
info_memory (int) : Gbytes
memory_available (int): % available memory
freq_max (int): Maximum frequency (GHz)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>num_max_processors (int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_common.date_in_name">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_common.</span></span><span class="sig-name descname"><span class="pre">date_in_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_common.date_in_name" title="Permalink to this definition"></a></dt>
<dd><p>introduces a date in the filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – filename</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filename with current date</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_common.get_date">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_common.</span></span><span class="sig-name descname"><span class="pre">get_date</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_common.get_date" title="Permalink to this definition"></a></dt>
<dd><p>gets current date and hour.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>date in text</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_common.load_data_common">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_common.</span></span><span class="sig-name descname"><span class="pre">load_data_common</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_common.load_data_common" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Common load data function to be used in all the modules.</dt><dd><p>The methods included are: npz, matlab</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<em>class</em>) – class X, XY, XZ, XYZ, etc..</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – filename</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True prints data</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_common.print_axis_info">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_common.</span></span><span class="sig-name descname"><span class="pre">print_axis_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_common.print_axis_info" title="Permalink to this definition"></a></dt>
<dd><p>Prints info about axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<em>class</em>) – class of the modulus.</p></li>
<li><p><strong>axis</strong><strong>(</strong><strong>)</strong> – axis x, y, z… etc.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_common.save_data_common">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_common.</span></span><span class="sig-name descname"><span class="pre">save_data_common</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cls</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_common.save_data_common" title="Permalink to this definition"></a></dt>
<dd><p>Common save data function to be used in all the modules.
The methods included are: npz, matlab</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename</p></li>
<li><p><strong>=</strong> (<em>add_name</em>) – sufix to the name, if ‘date’ includes a date</p></li>
<li><p><strong>description</strong> (<em>str</em>) – text to be stored in the dictionary to save.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If verbose prints filename.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filename. If False, file could not be saved.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_common.several_propagations">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_common.</span></span><span class="sig-name descname"><span class="pre">several_propagations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iluminacion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distances</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_common.several_propagations" title="Permalink to this definition"></a></dt>
<dd><p>performs RS propagation through several masks</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iluminacion</strong> (<em>Scalar_source_XY</em>) – illumination</p></li>
<li><p><strong>masks</strong> (<em>list</em>) – list with several (Scalar_masks_XY)</p></li>
<li><p><strong>distances</strong> (<em>list</em>) – list with seera distances</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>u0 field at the last plane given by distances
Scalar_field_XY: u1 field just at the plane of the last mask</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scalar_field_XY</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="pyqed-beam-utils-drawing-module">
<h2>pyqed.beam.utils_drawing module<a class="headerlink" href="#pyqed-beam-utils-drawing-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pyqed.beam.utils_math">
<span id="pyqed-beam-utils-math-module"></span><h2>pyqed.beam.utils_math module<a class="headerlink" href="#module-pyqed.beam.utils_math" title="Permalink to this heading"></a></h2>
<p>Common functions to classes</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.Bluestein_dft_x">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">Bluestein_dft_x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mout</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.Bluestein_dft_x" title="Permalink to this definition"></a></dt>
<dd><p>Bluestein dft</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>f1</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>f2</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>fs</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>mout</strong> (<em>_type_</em>) – _description_</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><ul class="simple">
<li><p>Hu, Y., Wang, Z., Wang, X., Ji, S., Zhang, C., Li, J., Zhu, W., Wu, D.,  Chu, J. (2020). “Efficient full-path optical calculation of scalar and vector diffraction using the Bluestein method”. Light: Science and Applications, 9(1). <a class="reference external" href="https://doi.org/10.1038/s41377-020-00362-z">https://doi.org/10.1038/s41377-020-00362-z</a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.Bluestein_dft_xy">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">Bluestein_dft_xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mout</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.Bluestein_dft_xy" title="Permalink to this definition"></a></dt>
<dd><p>Bluestein dft</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>f1</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>f2</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>fs</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>mout</strong> (<em>_type_</em>) – _description_</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.Bluestein_dft_xy_backup">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">Bluestein_dft_xy_backup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mout</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.Bluestein_dft_xy_backup" title="Permalink to this definition"></a></dt>
<dd><p>Bluestein dft</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>f1</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>f2</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>fs</strong> (<em>_type_</em>) – _description_</p></li>
<li><p><strong>mout</strong> (<em>_type_</em>) – _description_</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.amplitude2phase">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">amplitude2phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.amplitude2phase" title="Permalink to this definition"></a></dt>
<dd><p>Passes the amplitude of a complex field to phase. Previous phase is removed. <span class="math notranslate nohighlight">\(u = A e^{i \phi}  -&gt; e^(i abs(A))\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>u</strong> (<em>numpy.array</em><em>, </em><em>dtype=complex</em>) – complex field</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>only-phase complex vector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.binarize">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">binarize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.binarize" title="Permalink to this definition"></a></dt>
<dd><p>Binarizes vector between two levels, min and max. The central value is (min_value+max_value)/2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vector</strong> – (numpy.array) array with values to binarize</p></li>
<li><p><strong>min_value</strong> (<em>float</em>) – minimum value for binarization</p></li>
<li><p><strong>max_value</strong> (<em>float</em>) – maximum value for binarization</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>binarized vector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.cart2pol">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">cart2pol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.cart2pol" title="Permalink to this definition"></a></dt>
<dd><p>cartesian to polar coordinate transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – x coordinate</p></li>
<li><p><strong>y</strong> (<em>np.aray</em>) – y coordinate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>rho
numpy.array: phi</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.curl">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">curl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.curl" title="Permalink to this definition"></a></dt>
<dd><p>Returns the Curl of a field a given point (x0,y0,z0)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<em>numpy.array</em>) – complex field</p></li>
<li><p><strong>r</strong> (<em>numpy.array</em>) – 3x1 array with position r=(x,y,z).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Curl of the field at (x0,y0,z0)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.cut_function">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">cut_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.cut_function" title="Permalink to this definition"></a></dt>
<dd><p>takes values of function inside (x_center+length/2: x_center+length/2)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.delta_kronecker">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">delta_kronecker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.delta_kronecker" title="Permalink to this definition"></a></dt>
<dd><p>Delta kronecker</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>np.float</em>) – number</p></li>
<li><p><strong>b</strong> (<em>np.float</em>) – number</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if a==b and 0 if a&lt;&gt;b</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.discretize">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">discretize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'amplitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_field</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.discretize" title="Permalink to this definition"></a></dt>
<dd><p>Discretize in a number of levels equal to num_levels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kind</strong> (<em>str</em>) – “amplitude” o “phase”</p></li>
<li><p><strong>num_levels</strong> (<em>int</em>) – number of levels for the discretization</p></li>
<li><p><strong>factor</strong> (<em>float</em>) – from the level, how area is binarized. if 1 everything is binarized,</p></li>
<li><p><strong>phase0</strong> (<em>float</em>) – <ul>
<li></li>
</ul>
</p></li>
<li><p><strong>new_field</strong> (<em>bool</em>) – if True returns new field</p></li>
<li><p><strong>matrix</strong> (<em>bool</em>) – if True it returs a matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>if new_field is True returns scalar_fields_XY</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>scalar_fields_XY</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.distance">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.distance" title="Permalink to this definition"></a></dt>
<dd><p>Compute distance between two vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> (<em>numpy.array</em>) – vector 1</p></li>
<li><p><strong>x2</strong> (<em>numpy.array</em>) – vector 2</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>distance between vectors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.divergence">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.divergence" title="Permalink to this definition"></a></dt>
<dd><p>Returns the divergence of a field a given point (x0,y0,z0).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<em>numpy.array</em>) – complex field</p></li>
<li><p><strong>r</strong> (<em>numpy.array</em>) – 3x1 array with position r=(x,y,z).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Divergence of the field at (x0,y0,z0)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.dot_product">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">dot_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.dot_product" title="Permalink to this definition"></a></dt>
<dd><p>Returns the dot product between two vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>numpy.array</em>) – 3x1 vector array.</p></li>
<li><p><strong>B</strong> (<em>numpy.array</em>) – 3x1 vector array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3x1 dot product</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(complex)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.fZernike">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">fZernike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.fZernike" title="Permalink to this definition"></a></dt>
<dd><p>Zernike function for aberration computation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>k&gt;=l</p>
<p>if k is even then l is even.
if k is  odd then l is  odd.</p>
<p>The first polinomial is the real part ant the second de imaginary part.</p>
<ul class="simple">
<li><p>n     m        aberración</p></li>
<li><p>0     0        piston</p></li>
<li><p>1    -1        vertical tilt</p></li>
<li><p>1     1        horizontal tilt</p></li>
<li><p>2    -2        astigmatismo oblicuo</p></li>
<li><p>2     0        desenfoque miopía si c&gt;0 o desenfoque hipermetropía si c&lt;0</p></li>
<li><p>2     2        astigmatismo anormal si c&gt;0 o astigmatismo normal si c&lt;0</p></li>
<li><p>3    -3        trebol oblicuo</p></li>
<li><p>3    -1        coma vertical, c&gt;0 empinamiento superior, c&lt;0 emp. inferior</p></li>
<li><p>3     1        como horizontal</p></li>
<li><p>3     3        trebol horizontal</p></li>
<li><p>4    -4        trebol de cuatro hojas oblicuo</p></li>
<li><p>4    -2        astigmatismo secundario oblicuo</p></li>
<li><p>4     0        esférica c&gt;0 periferia más miópica que centro, c&lt;0 periferia más hipertrópica que el centro</p></li>
<li><p>4     2        astigmatismo secundario a favor o en contra de la regla</p></li>
<li><p>4     4        trebol de cuatro hojas horizontal</p></li>
</ul>
</div>
<p>Reference:</p>
<blockquote>
<div><ol class="upperalpha simple" start="18">
<li><p>Navarro, J. Arines, R. Rivera “Direct and inverse discrete Zernike transform” Opt. Express 17(26) 24269</p></li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.fft_convolution1d">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">fft_convolution1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.fft_convolution1d" title="Permalink to this definition"></a></dt>
<dd><p>1D convolution, using FFT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.array</em>) – array 1 to convolve</p></li>
<li><p><strong>y</strong> (<em>numpy.array</em>) – array 2 to convolve</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>convolved function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.fft_convolution2d">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">fft_convolution2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.fft_convolution2d" title="Permalink to this definition"></a></dt>
<dd><p>2D convolution, using FFT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.array</em>) – array 1 to convolve</p></li>
<li><p><strong>y</strong> (<em>numpy.array</em>) – array 2 to convolve</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>convolved function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.fft_correlation1d">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">fft_correlation1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.fft_correlation1d" title="Permalink to this definition"></a></dt>
<dd><p>1D correlation, using FFT (fftconvolve)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.array</em>) – array 1 to convolve</p></li>
<li><p><strong>y</strong> (<em>numpy.array</em>) – array 2 to convolve</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>correlation function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.fft_correlation2d">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">fft_correlation2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.fft_correlation2d" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.array</em>) – array 1 to convolve</p></li>
<li><p><strong>y</strong> (<em>numpy.array</em>) – array 2 to convolve</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2d correlation function</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.fft_filter">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">fft_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.fft_filter" title="Permalink to this definition"></a></dt>
<dd><p>1D convolution, using FFT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.array</em>) – array 1 to convolve</p></li>
<li><p><strong>y</strong> (<em>numpy.array</em>) – array 2 to convolve</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>convolved function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.filter_edge_1D">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">filter_edge_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.filter_edge_1D" title="Permalink to this definition"></a></dt>
<dd><p>function 1 at center and reduced at borders. For propagation algorithms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – position</p></li>
<li><p><strong>size</strong> (<em>float</em>) – related to relative position of x</p></li>
<li><p><strong>exponent</strong> (<em>integer</em>) – related to shape of edges</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>function for filtering</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.filter_edge_2D">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">filter_edge_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.filter_edge_2D" title="Permalink to this definition"></a></dt>
<dd><p>function 1 at center and reduced at borders. For propagation algorithms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – x position</p></li>
<li><p><strong>y</strong> (<em>np.array</em>) – y position</p></li>
<li><p><strong>size</strong> (<em>float</em>) – related to relative position of x and y</p></li>
<li><p><strong>exponent</strong> (<em>integer</em>) – related to shape of edges</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>function for filtering</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.find_extrema">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">find_extrema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.find_extrema" title="Permalink to this definition"></a></dt>
<dd><p>In a 2D-array, formed by vectors x, and y, the maxima or minima are found</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array2D</strong> (<em>np. array 2D</em>) – 2D array with variable</p></li>
<li><p><strong>x</strong> (<em>np.array 1D</em>) – 1D array with x axis</p></li>
<li><p><strong>y</strong> (<em>np.array 1D</em>) – 1D array with y axis</p></li>
<li><p><strong>kind</strong> (<em>str</em>) – ‘min’ or ‘max’: detects minima or maxima</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True prints data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>indexes of the position
xy_ext (float, float): position of maximum
extrema (float): value of maximum</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>indexes (int,int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.get_amplitude">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">get_amplitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.get_amplitude" title="Permalink to this definition"></a></dt>
<dd><p>Gets the amplitude of the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>numpy.array</em>) – Field.</p></li>
<li><p><strong>sign</strong> (<em>bool</em>) – If True, sign is kept, else, it is removed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.get_edges">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">get_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind_transition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'amplitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.get_edges" title="Permalink to this definition"></a></dt>
<dd><p>We have a binary mask and we obtain locations of edges.
valid for litography engraving of gratings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – position x</p></li>
<li><p><strong>f</strong> (<em>numpy.array</em>) – Field. If real function, use ‘amplitude’ in kind_transition.</p></li>
<li><p><strong>kind_transition</strong> (<em>str</em>) – ‘amplitude’ ‘phase’ of the field where to get the transitions.</p></li>
<li><p><strong>min_step</strong> (<em>float</em>) – minimum step for consider a transition</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True prints information about the process.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – If not ‘’, saves the data on files. filename is the file name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>array with +1, -1 with rasing or falling edges
pos_transition (numpy.array): positions x of transitions
raising (numpy.array): positions of raising
falling (numpy.array): positions of falling</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>type_transition (numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.get_k">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">get_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flavour</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.get_k" title="Permalink to this definition"></a></dt>
<dd><p>provides k vector from x vector. Two flavours are provided (ordered + or disordered - )</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – x array</p></li>
<li><p><strong>flavour</strong> (<em>str</em>) – ‘+’ or ‘-’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>k vector</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>kx (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.get_phase">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">get_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.get_phase" title="Permalink to this definition"></a></dt>
<dd><p>Gets the phase of the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>u</strong> (<em>numpy.array</em>) – Field.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.laguerre_polynomial_nk">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">laguerre_polynomial_nk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.laguerre_polynomial_nk" title="Permalink to this definition"></a></dt>
<dd><p>Auxiliar laguerre polinomial of orders n and k
function y = LaguerreGen(varargin)
LaguerreGen calculates the utilsized Laguerre polynomial L{n, alpha}
This function computes the utilsized Laguerre polynomial L{n,alpha}.
If no alpha is supplied, alpha is set to zero and this function
calculates the “normal” Laguerre polynomial.</p>
<p>Parameters:
- n = nonnegative integer as degree level
- alpha &gt;= -1 real number (input is optional)</p>
<p>The output is formated as a polynomial vector of degree (n+1)
corresponding to MatLab norms (that is the highest coefficient
is the first element).</p>
<p>Example:
- polyval(LaguerreGen(n, alpha), x) evaluates L{n, alpha}(x)
- roots(LaguerreGen(n, alpha)) calculates roots of L{n, alpha}</p>
<p>Calculation is done recursively using matrix operations for very fast
execution time.</p>
<p>Author: <a class="reference external" href="mailto:Matthias&#46;Trampisch&#37;&#52;&#48;rub&#46;de">Matthias<span>&#46;</span>Trampisch<span>&#64;</span>rub<span>&#46;</span>de</a>
Date: 16.08.2007
Version 1.2</p>
<p class="rubric">References</p>
<p>Szeg: “Orthogonal Polynomials” 1958, formula (5.1.10)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.ndgrid">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">ndgrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.ndgrid" title="Permalink to this definition"></a></dt>
<dd><p>n-dimensional gridding like Matlab’s NDGRID</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequences</strong> (<em>The input *args are an arbitrary number</em><em> of </em><em>numerical</em>) – </p></li>
<li><p><strong>lists</strong> (<em>e.g.</em>) – </p></li>
<li><p><strong>arrays</strong> – </p></li>
<li><p><strong>tuples.</strong> (<em>or</em>) – </p></li>
<li><p><strong>argument</strong> (<em>The i-th dimension</em><em> of </em><em>the i-th output</em>) – </p></li>
<li><p><strong>argument.</strong> (<em>has copies</em><em> of </em><em>the i-th input</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">ndgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="go"># unpacking the returned ndarray into X, Y, Z</span>
</pre></div>
</div>
<p>Each of X, Y, Z has shape [len(v) for v in x, y, z].</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">Y</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">Z</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span>
<span class="go">array([[[0, 0, 0, 0],</span>
<span class="go">                [0, 0, 0, 0],</span>
<span class="go">                [0, 0, 0, 0]],</span>
<span class="go">           [[1, 1, 1, 1],</span>
<span class="go">                [1, 1, 1, 1],</span>
<span class="go">                [1, 1, 1, 1]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Y</span>
<span class="go">array([[[2, 2, 2, 2],</span>
<span class="go">                [3, 3, 3, 3],</span>
<span class="go">                [4, 4, 4, 4]],</span>
<span class="go">           [[2, 2, 2, 2],</span>
<span class="go">                [3, 3, 3, 3],</span>
<span class="go">                [4, 4, 4, 4]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span>
<span class="go">array([[[5, 6, 7, 8],</span>
<span class="go">                [5, 6, 7, 8],</span>
<span class="go">                [5, 6, 7, 8]],</span>
<span class="go">           [[5, 6, 7, 8],</span>
<span class="go">                [5, 6, 7, 8],</span>
<span class="go">                [5, 6, 7, 8]]])</span>
</pre></div>
</div>
<p>With an unpacked argument list:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ndgrid</span><span class="p">(</span><span class="o">*</span><span class="n">V</span><span class="p">)</span> <span class="c1"># an array of two arrays with shape (2, 3)</span>
<span class="go">array([[[0, 0, 0],</span>
<span class="go">                [1, 1, 1]],</span>
<span class="go">           [[2, 3, 4],</span>
<span class="go">                [2, 3, 4]]])</span>
</pre></div>
</div>
<p>For input vectors of different data kinds,
same_dtype=False makes ndgrid()
return a list of arrays with the respective dtype.
&gt;&gt;&gt; ndgrid([0, 1], [1.0, 1.1, 1.2], same_dtype=False)
[array([[0, 0, 0], [1, 1, 1]]),</p>
<blockquote>
<div><p>array([[ 1. ,  1.1,  1.2], [ 1. ,  1.1,  1.2]])]</p>
</div></blockquote>
<p>Default is to return a single array.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ndgrid</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="go">array([[[ 0. ,  0. ,  0. ], [ 1. ,  1. ,  1. ]],</span>
<span class="go">           [[ 1. ,  1.1,  1.2], [ 1. ,  1.1,  1.2]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.nearest">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">nearest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.nearest" title="Permalink to this definition"></a></dt>
<dd><p>Computes the nearest element in vector to number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vector</strong> (<em>numpy.array</em>) – array with numbers</p></li>
<li><p><strong>number</strong> (<em>float</em>) – number to determine position</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>index - index of vector which is closest to number.
(float): value  - value of vector[index].
(float): distance - difference between number and chosen element.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(int)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.nearest2">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">nearest2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numbers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.nearest2" title="Permalink to this definition"></a></dt>
<dd><p>Computes the nearest element in vector to numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vector</strong> (<em>numpy.array</em>) – array with numbers</p></li>
<li><p><strong>number</strong> (<em>numpy.array</em>) – numbers to determine position</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>index - indexes of vector which is closest to number.
(numpy.array): value  - values of vector[indexes].
(numpy.array): distance - difference between numbers and chosen elements.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.nextpow2">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">nextpow2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.nextpow2" title="Permalink to this definition"></a></dt>
<dd><p>Exponent of next higher power of 2. It returns the exponents for the smallest powers of two that satisfy $2^p≥A$ for each element in A.
By convention, nextpow2(0) returns zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>float</em>) – value</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Exponent of next higher power of 2</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>integer</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.normalize">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Normalize vectors with different L norm (standard is 2).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>numpy.array</em>) – vector to normalize</p></li>
<li><p><strong>order</strong> (<em>int</em>) – order for norm</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>normalized vector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.phase2amplitude">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">phase2amplitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.phase2amplitude" title="Permalink to this definition"></a></dt>
<dd><p>Passes the phase of a complex field to amplitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>u</strong> (<em>numpy.array</em><em>, </em><em>dtype=complex</em>) – complex field</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>amplitude without phase complex vector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.pol2cart">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">pol2cart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.pol2cart" title="Permalink to this definition"></a></dt>
<dd><p>polar to cartesian coordinate transformation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho</strong> (<em>np.aray</em>) – rho coordinate</p></li>
<li><p><strong>rho</strong> – rho coordinate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>x
numpy.array: y</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.reduce_to_1">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">reduce_to_1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_diffractio</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.reduce_to_1" title="Permalink to this definition"></a></dt>
<dd><p>All the values greater than 1 pass to 1. This is used for Scalar_masks when we add two masks.
:param class: Scalar_field_X, XY ,….
:type class: class</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.rotate_image">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">rotate_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pivot_point</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.rotate_image" title="Permalink to this definition"></a></dt>
<dd><p>similar to rotate image, but not from the center but from the given</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>np.array</em>) – image to rotate</p></li>
<li><p><strong>angle</strong> (<em>float</em>) – angle to rotate</p></li>
<li><p><strong>pivot_point</strong> (<em>float</em><em>, </em><em>float</em>) – (z,x) position for rotation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>rotated image</p>
</dd>
</dl>
<dl class="simple">
<dt>Reference:</dt><dd><p><a class="reference external" href="https://stackoverflow.com/questions/25458442/rotate-a-2d-image-around-specified-origin-in-python">https://stackoverflow.com/questions/25458442/rotate-a-2d-image-around-specified-origin-in-python</a> point</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_math.vector_product">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_math.</span></span><span class="sig-name descname"><span class="pre">vector_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_math.vector_product" title="Permalink to this definition"></a></dt>
<dd><p>Returns the vector product between two vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>numpy.array</em>) – 3x1 vector array.</p></li>
<li><p><strong>B</strong> (<em>numpy.array</em>) – 3x1 vector array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>3x1 vector product array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.array)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyqed.beam.utils_multiprocessing">
<span id="pyqed-beam-utils-multiprocessing-module"></span><h2>pyqed.beam.utils_multiprocessing module<a class="headerlink" href="#module-pyqed.beam.utils_multiprocessing" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyqed.beam.utils_multiprocessing.auxiliar_multiprocessing">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_multiprocessing.</span></span><span class="sig-name descname"><span class="pre">auxiliar_multiprocessing</span></span><a class="headerlink" href="#pyqed.beam.utils_multiprocessing.auxiliar_multiprocessing" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pyqed.beam.utils_multiprocessing.auxiliar_multiprocessing.execute_multiprocessing">
<span class="sig-name descname"><span class="pre">execute_multiprocessing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_constants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ncores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_multiprocessing.auxiliar_multiprocessing.execute_multiprocessing" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyqed.beam.utils_multiprocessing.auxiliar_multiprocessing.method_single_proc">
<span class="sig-name descname"><span class="pre">method_single_proc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elem_iterable</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_multiprocessing.auxiliar_multiprocessing.method_single_proc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_multiprocessing.execute_multiprocessing">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_multiprocessing.</span></span><span class="sig-name descname"><span class="pre">execute_multiprocessing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">__function_process__</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dict_Parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_processors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_multiprocessing.execute_multiprocessing" title="Permalink to this definition"></a></dt>
<dd><p>Executes multiprocessing reading a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>process</strong> (<em>__function_process__ function tu</em>) – </p></li>
<li><p><strong>dictionary</strong> (<em>it only accepts a</em>) – </p></li>
<li><p><strong>dict_Parameters</strong> – </p></li>
<li><p><strong>Parameters</strong> (<em>dictionary / array with</em>) – </p></li>
<li><p><strong>num_processors</strong> – </p></li>
<li><p><strong>used</strong> (<em>if 1 no multiprocessing is</em>) – </p></li>
<li><p><strong>verbose</strong> – </p></li>
<li><p><strong>time</strong> (<em>prints processing</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reults of multiprocessing
processing time</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>data</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<dl>
<dt>def __function_process__(xd):</dt><dd><p>x = xd[‘x’]
y = xd[‘y’]
# grt = copy.deepcopy(grating)
suma = x + y
return dict(sumas=suma, ij=xd[‘ij’])</p>
</dd>
<dt>def creation_dictionary_multiprocessing():</dt><dd><p># create Parameters: for multiprocessing
t1 = time.time()
X = np.linspace(1, 2, 10)
Y = np.linspace(1, 2, 1000)
dict_Parameters = []
ij = 0
for i, x in enumerate(X):</p>
<blockquote>
<div><dl class="simple">
<dt>for j, y in enumerate(Y):</dt><dd><p>dict_Parameters.append(dict(x=x, y=y, ij=[ij]))
ij += 1</p>
</dd>
</dl>
</div></blockquote>
<p>t2 = time.time()
print(“time creation dictionary = {}”.format(t2 - t1))
return dict_Parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyqed.beam.utils_multiprocessing.separate_from_iterable">
<span class="sig-prename descclassname"><span class="pre">pyqed.beam.utils_multiprocessing.</span></span><span class="sig-name descname"><span class="pre">separate_from_iterable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyqed.beam.utils_multiprocessing.separate_from_iterable" title="Permalink to this definition"></a></dt>
<dd><p>This function does somehow the opposite of the previous one, it takes an iterable made of lists and separates each one in a different variable, reshaped with the desired shape</p>
</dd></dl>

</section>
<section id="pyqed-beam-utils-optics-module">
<h2>pyqed.beam.utils_optics module<a class="headerlink" href="#pyqed-beam-utils-optics-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-utils-slicer-module">
<h2>pyqed.beam.utils_slicer module<a class="headerlink" href="#pyqed-beam-utils-slicer-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-utils-tests-module">
<h2>pyqed.beam.utils_tests module<a class="headerlink" href="#pyqed-beam-utils-tests-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-vector-fields-xy-module">
<h2>pyqed.beam.vector_fields_XY module<a class="headerlink" href="#pyqed-beam-vector-fields-xy-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-vector-masks-xy-module">
<h2>pyqed.beam.vector_masks_XY module<a class="headerlink" href="#pyqed-beam-vector-masks-xy-module" title="Permalink to this heading"></a></h2>
</section>
<section id="pyqed-beam-vector-sources-xy-module">
<h2>pyqed.beam.vector_sources_XY module<a class="headerlink" href="#pyqed-beam-vector-sources-xy-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-pyqed.beam">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyqed.beam" title="Permalink to this heading"></a></h2>
<p>Top-level package for Python Scalar and vector diffraction and interference.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Bing Gu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>